# Rivet Pro Environment Configuration

# ============================================================================
# LLM PROVIDERS
# ============================================================================
GROQ_API_KEY=your_groq_api_key_here
GEMINI_API_KEY=your_gemini_api_key_here
ANTHROPIC_API_KEY=your_anthropic_api_key_here
OPENAI_API_KEY=your_openai_api_key_here

# ============================================================================
# DATABASE
# ============================================================================
# Neon PostgreSQL (Primary)
DATABASE_URL=postgresql://user:password@host/database

# ============================================================================
# REDIS (Upstash - for 24/7 KB Worker)
# ============================================================================
# Create free Redis at https://upstash.com
# Required for KB ingestion job queue
REDIS_URL=redis://default:xxx@xxx.upstash.io:6379

# ============================================================================
# SLACK NOTIFICATIONS (for 24/7 workers)
# ============================================================================
# Create incoming webhook at https://api.slack.com/apps
# Used for hourly status updates from KB workers
SLACK_WEBHOOK_URL=https://hooks.slack.com/services/xxx/xxx/xxx

# ============================================================================
# ATLAS CMMS API
# ============================================================================
ATLAS_BASE_URL=http://localhost:8080/api
ATLAS_EMAIL=admin@example.com
ATLAS_PASSWORD=admin
ATLAS_TIMEOUT=30.0
ATLAS_MAX_RETRIES=3
ATLAS_ENABLED=true
ATLAS_TOKEN_TTL=86400
ATLAS_TOKEN_REFRESH_BUFFER=300

# ============================================================================
# WHATSAPP CLOUD API (Optional)
# ============================================================================
# WhatsApp adapter is completely separate from Telegram.
# All fields are optional - adapter is disabled if not configured.
# Get credentials from Meta Developer Portal: https://developers.facebook.com/

# Phone Number ID (NOT the phone number itself) - found in WhatsApp > Getting Started
# WHATSAPP_PHONE_NUMBER_ID=123456789012345

# WhatsApp Business Account ID - found in WhatsApp > Getting Started
# WHATSAPP_BUSINESS_ACCOUNT_ID=987654321098765

# Access Token - use a System User token for production
# Generate at: Business Settings > Users > System Users > Generate Token
# Required permissions: whatsapp_business_management, whatsapp_business_messaging
# WHATSAPP_ACCESS_TOKEN=EAAxxxxxxxxxxxxxxxxxxxxxxxx

# Verify Token - custom string YOU create for webhook verification
# Generate with: openssl rand -hex 32
# WHATSAPP_VERIFY_TOKEN=your_random_verify_token_here

# App Secret - from App Settings > Basic > App Secret
# Used for webhook signature verification (HMAC-SHA256)
# WHATSAPP_APP_SECRET=abcdef123456789

# ============================================================================
# TELEGRAM BOT (Optional)
# ============================================================================
TELEGRAM_BOT_TOKEN=your_telegram_bot_token_here
# Admin chat ID for alerts, notifications, and admin commands
TELEGRAM_ADMIN_CHAT_ID=your_telegram_user_id_here

# Webhook Configuration (Production)
# Use webhook mode for production deployment with HTTPS
TELEGRAM_BOT_MODE=polling  # Options: "polling" (dev) or "webhook" (production)
TELEGRAM_WEBHOOK_URL=https://your-domain.com/telegram-webhook  # Required for webhook mode
TELEGRAM_WEBHOOK_SECRET=your_webhook_secret_token  # Optional but recommended for security
TELEGRAM_WEBHOOK_PORT=8443  # Port for webhook server (default: 8443)

# n8n Webhook URL for photo processing
N8N_WEBHOOK_URL=http://localhost:5678/webhook/photo-bot-v2

# ============================================================================
# PAYMENT (Optional)
# ============================================================================
STRIPE_API_KEY=your_stripe_api_key_here
STRIPE_WEBHOOK_SECRET=your_stripe_webhook_secret_here

# ============================================================================
# OBSERVABILITY (Optional)
# ============================================================================
LANGSMITH_API_KEY=your_langsmith_api_key_here
LANGSMITH_PROJECT=rivet-pro

# ============================================================================
# API CONFIGURATION
# ============================================================================
# FastAPI web server settings
API_HOST=0.0.0.0
API_PORT=8000
API_WORKERS=4

# ============================================================================
# FEATURE FLAGS (Optional)
# ============================================================================
# Override feature flags from rivet_pro/config/feature_flags.json
# Format: RIVET_FLAG_<FLAG_NAME_UPPERCASE>=true/false
# Example: Enable new manual matching algorithm with LLM validation
RIVET_FLAG_RIVET_MIGRATION_MANUAL_MATCHER_V2=true
# Example: Enable experimental OCR engine
# RIVET_FLAG_RIVET_EXPERIMENT_NEW_OCR=false

# ============================================================================
# PRODUCTION DEPLOYMENT CHECKLIST
# ============================================================================
# Before deploying to production:
# 1. Set TELEGRAM_BOT_MODE=webhook
# 2. Configure TELEGRAM_WEBHOOK_URL with your HTTPS domain
# 3. Set strong TELEGRAM_WEBHOOK_SECRET
# 4. Update N8N_WEBHOOK_URL with production n8n URL
# 5. Ensure DATABASE_URL points to production Neon database
# 6. Set ATLAS_BASE_URL to production CMMS API
# 7. Configure Stripe keys for payment processing
# 8. Enable SSL/HTTPS (see DEPLOYMENT.md)
# 9. Set up systemd services (see DEPLOYMENT.md)
# 10. Configure nginx reverse proxy (see DEPLOYMENT.md)
